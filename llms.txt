# JETNET API (Jetnet Connect) -- AI Agent Reference

> Base URL: https://customer.jetnetconnect.com
> Swagger: https://customer.jetnetconnect.com/swagger/index.html
> This file is optimized for LLM context windows. For the full reference, see llms-full.txt.

## Common Use Cases

- Aircraft Sales & Brokerage: tail lookup, owner identification, for-sale inventory, comparable sales history
- Fleet Intelligence: fleet composition by model/country/operator, ownership tracking, lifecycle monitoring
- Market Analytics: pricing trends, inventory levels, days-on-market, supply/demand time-series
- CRM Enrichment: ownership contacts, flight activity, base airport, charter/fractional identification
- Data Integration: bulk export with delta sync, automated ownership change alerts, transaction monitoring
- Valuation & Diligence: market benchmarks, transaction history, utilization data, operating costs

See references/vertical-playbooks.md for 9 detailed industry-specific workflows.

## Authentication

POST /api/Admin/APILogin
Body: { "emailAddress": "...", "password": "..." }
Response: { "bearerToken": "...", "apiToken": "..." }

Rules:
- Field is `emailAddress` (capital A). Not `email`, `emailaddress`, or `email_address`.
- `bearerToken` goes in header: `Authorization: Bearer {bearerToken}`
- `apiToken` goes in URL path only: `/api/Aircraft/getRegNumber/N123AB/{apiToken}`
- Never put apiToken in headers or body. Never put bearerToken in the URL.
- Tokens expire after 60 minutes. Proactively refresh at 50 minutes.
- Validate with: GET /api/Admin/getAccountInfo/{apiToken}
- On "INVALID SECURITY TOKEN": re-login once and retry. Never loop.

## Critical Gotchas

1. HTTP 200 does NOT mean success. Always check `responsestatus` for "ERROR".
2. `transtype: ["None"]` not `[]` for all transaction types.
3. `forsale` is string `"true"`/`"false"` in requests, `"Y"`/`"N"` in bulk export responses.
4. Dates must be `MM/DD/YYYY` with leading zeros. Month first, not day.
5. `modlist: []` means no filter (all models), not empty results.
6. `aclist: []` means no filter (all aircraft), not empty results.
7. `maxpages: 0` from bulk export = single page. Use `max(maxpages, 1)`.
8. `companyrelation` (getRegNumber flat) vs `relationtype` (getRelationships nested) -- different endpoints use different field names.
9. `regnbr` (tail number) can change. Use `aircraftid` as your stable database key.
10. Pagination is 1-based (first page = 1, not 0).

## The Golden Path (Tail Lookup)

1. GET /api/Aircraft/getRegNumber/{tailNumber}/{apiToken} -> aircraftresult (includes aircraftid)
2. GET /api/Aircraft/getPictures/{aircraftid}/{apiToken} -> pictures[]
   POST /api/Aircraft/getRelationships/{apiToken} body: {"aclist":[aircraftid],"modlist":[]} -> relationships[]
   POST /api/Aircraft/getFlightDataPaged/{apiToken}/100/1 body: {"aclist":[aircraftid],"modlist":[],...} -> flightdata[]
3. POST /api/Aircraft/getHistoryListPaged/{apiToken}/100/1 body: {"aclist":[aircraftid],"modlist":[],"transtype":["None"],...} -> history[] (lazy)

All POST endpoints require a JSON body with at minimum aclist and modlist. See prompts/ or docs/ for full payload shapes.

## Response Keys by Endpoint

| Endpoint | Response Key | Type |
|----------|-------------|------|
| getRegNumber | aircraftresult | Object |
| getAircraftList | aircraft | Array |
| getHistoryListPaged | history | Array |
| getFlightDataPaged | flightdata | Array |
| getEventListPaged | events | Array |
| getRelationships | relationships | Array |
| getBulkAircraftExport | aircraft | Array |
| getCondensedOwnerOperators | aircraftowneroperators | Array |
| getPictures | pictures | Array |
| getCompanyListPaged | companylist | Array |
| getContactListPaged | contactlist | Array |
| getModelMarketTrends | modelMarketTrends | Object |
| getAcCompanyFractionalReportPaged | aircraftcompfractionalrefs | Array |

## Enum Values

airframetype: None, FixedWing, Rotary
maketype: None, JetAirliner, BusinessJet, Turboprop, Piston, Turbine
lifecycle: None, InProduction, NewWithManufacturer, InOperation, Retired, InStorage
forsale (request): "true", "false", ""
isnewaircraft / ispreownedtrans / isinternaltrans: Yes, No, Ignore
transtype (request categories): None, FullSale, Lease, InternalSale, Management, Insurance, Repossession, Registration
  NOTE: Response transtype values are different (descriptive strings like "Full Sale - Retail to Retail"). Do not use response values in request payloads.

## ID System

| ID | Type | Purpose | Stable? |
|----|------|---------|---------|
| aircraftid | int | Primary key for aircraft, join key for all sub-records | Yes |
| regnbr | string | Tail number (human-readable) | No -- can change |
| modelid / AMODID | int | Aircraft model, used in modlist arrays | Yes |
| companyid | int | Company/entity ID | Yes |
| contactid | int | Person ID | Yes |
| transid | int | Transaction record ID (for dedup) | Yes |
| serialnbr | string | Manufacturer serial number | Yes |
| baseicao | string | Home airport (4-char ICAO code) | Changes |

## Model IDs (modlist)

872 unique model IDs across 67 makes and 5 make types.
Full machine-readable table: references/model-id-table.json

Common examples:
- Gulfstream G550: modlist [278]
- Gulfstream G650 + G650ER: modlist [663, 1211]
- Citation Latitude: modlist [1167]
- All Citation CJ3 variants: modlist [279, 1194]
- Challenger 350: modlist [1188]
- King Air 350: modlist [142]
- Bell 407: modlist [100]
- modlist: [] = no filter (all models)

## Pagination Pattern

URL: POST .../getHistoryListPaged/{apiToken}/{pagesize}/{page}
Pages are 1-based. Use `maxpages` for loop control.

```python
results, page = [], 1
while True:
    data = api("POST", f"{path}/{pagesize}/{page}", bearer, token, body)
    for key in ["history","flightdata","events","aircraft","aircraftowneroperators","companylist","contactlist","relationships","aircraftcompfractionalrefs"]:
        if key in data and isinstance(data[key], list):
            results.extend(data[key])
            break
    if page >= max(data.get("maxpages", 1), 1):
        break
    page += 1
```

## Schema Differences (Owner/Operator)

| Endpoint | Schema | Relation Field |
|----------|--------|---------------|
| getRegNumber | Flat: companyname, contactfirstname | companyrelation |
| getRelationships / getHistoryList | Nested: company.name, contact.firstname | relationtype |
| getBulkAircraftExport | Prefixed: owrcompanyname, oprcompanyname | prefix (owr*, opr*, chp*) |
| getAcCompanyFractionalReportPaged | Flat: companyname | relation |

## Normalized Response Shapes

AircraftCard: aircraftId, modelId, tailNumber, serialNumber, make, model, yearMfr, yearDelivered, makeType, airframeType, weightClass, categorySize, lifecycle, forSale, owner (CompanyCard), operator (CompanyCard)

CompanyCard: companyId, name, city, state, country, phone, email, contact (ContactCard)

ContactCard: contactId, firstName, lastName, title, email, phone

GoldenPathResult: aircraftId, tailNumber, make, model, yearMfr, yearDelivered, categorySize, weightClass, forSale, askingPrice, owner, operator, chiefPilot, baseIcao, baseAirport, baseCountry, dataSource="JETNET"

## Bulk Export (getBulkAircraftExportPaged)

Two operating modes:
- Snapshot: omit `aircraftchanges` -> full dataset matching filters
- Delta: `aircraftchanges=true` -> aircraft with changes since your last API call (backend tracks this automatically)

Key behaviors:
- Delta uses graph-based change detection: aircraft qualifies if ANY related entity changes (ownership, contacts, events, flights) -- not just the aircraft record.
- Delta returns full records, not field-level diffs. Always upsert entire records.
- `aircraftchanges=true` means "since last call" -- the backend tracks the cursor, not the client.
- `actiondate`/`enddate` are optional date-range filters, not the change cursor. Accepts `MM/DD/YYYY HH:MM:SS`.
- Entity counts scale nonlinearly: each aircraft expands into companies, contacts, phones, events, flight summaries.
- Always scope with `modlist` or `aclist`. Unbounded queries create massive payloads.
- Response uses flat prefixed schema: owr* (owner), opr* (operator), chp* (chief pilot).
- `forsale` is "Y"/"N" (not "true"/"false"). `datepurchased` is YYYYMMDD.
- `maxpages: 0` = single page. Use max(maxpages, 1).

Integration pattern: initial full snapshot -> store locally -> periodic delta pulls with aircraftchanges=true -> upsert entire records.

## History Endpoints (getHistoryListPaged / getCompanyHistoryPaged)

History records are transaction EVENTS, not aircraft state. Each record = a sale, lease, transfer, or relationship change.

POST /api/Aircraft/getHistoryListPaged/{apiToken}/{pagesize}/{page}
POST /api/Company/getCompanyHistoryPaged/{apiToken}/{pagesize}/{page}

Key behaviors:
- Response key: `history` (array). Uses nested relationship schema (company:{}, contact:{} sub-objects).
- `transtype` in request = categories ("FullSale", "Lease", "None"); in response = descriptive strings ("Full Sale - Retail to Retail").
- `isnewaircraft` and `isinternaltrans` are tristate: "Yes", "No", "Ignore".
- `allrelationships: true` returns all parties: Seller, Purchaser, Operator, Seller's Broker, Purchaser's Broker.
- `soldprice`/`askingprice` are often null (confidential deals). `transretail: true` = arm's length retail transaction.
- `transdate` = actual transaction date. `actiondate` = when JETNET last updated the record.
- History records are event pointers — enrich with getRelationships/getAircraftList/getCompany for full context.
- Always provide startdate/enddate + modelid/modlist/companyid to bound queries.

Use cases: ownership timeline (sort by transdate ASC), comparable sales (transtype=FullSale + transretail), leasing intelligence, change detection alerts.

## Snapshot Endpoint (getCondensedSnapshot)

Returns frozen fleet ownership/operator state at a specific historical date. A "time machine" for fleet composition.

POST /api/Aircraft/getCondensedSnapshot/{apiToken}

Key behaviors:
- `snapshotdate` (MM/DD/YYYY) is the required defining parameter.
- Response key: `snapshotowneroperators` (array).
- Non-paged: returns full dataset in one response (can be multi-MB).
- Always filter by modlist, basecountry, maketype, or aclist to keep payloads manageable.
- Snapshot data is historical and immutable — cache aggressively.
- Conceptual model: Snapshot=STATE, History=CHANGE, Current=NOW, FlightData=ACTIVITY.

Use cases: historical fleet composition, "who owned this in year X?", market comparison across years, country fleet growth analysis.

## Model Market Trends (getModelMarketTrends)

POST /api/Model/getModelMarketTrends/{apiToken}

Monthly time-series at model-level granularity. One record per model per month.

Request: modlist (array of model IDs), displayRange (months), startdate (MM/DD/YYYY).
Response key: `modelMarketTrends` (camelCase with capital M).

Key fields per record: trend_year, trend_month, aircraft_for_sale_count, in_operation_count, avg_asking_price, high_asking_price, low_asking_price, avg_daysonmarket, avg_airframe_time, avg_engine_time, domestic_count, international_count, dealer_owned_count, end_user_count.

Derived metrics:
- Supply Pressure = aircraft_for_sale_count / in_operation_count
- Liquidity Score = inverse of avg_daysonmarket slope
- Price Trend Index = MoM change in avg_asking_price

Combine with Snapshots (state), History (transactions), Events (causal), and Flight Data (utilization) for full longitudinal analytics. See docs/trends.md for composite indicators and architecture.

## Events (getEventListPaged)

POST /api/Aircraft/getEventListPaged/{apiToken}/{pagesize}/{page}

Discrete, timestamped aircraft lifecycle changes. The atomic causal layer of the dataset.

Request: evcategory (array), evtype (array), startdate/enddate (MM/DD/YYYY), aclist, modlist.
Response key: `events` (array). Fields: aircraftid, make, model, sernbr, regnbr, yearmfr, date (ISO), subject, description.

Key behaviors:
- evcategory and evtype enum values are STRICT. Unrecognized values return errors inside responsestatus (HTTP 200).
- Use [] for both evcategory and evtype to return all events (safest default).
- Call GET /api/Utility/getEventCategories/{apiToken} and POST /api/Utility/getEventTypes/{apiToken} to discover valid values.
- Known categories: Aircraft Information, Company / Contact, Financial Documents, Market Status, Transaction.
- Example types: Change in Aircraft Base, Change in Airframe Total Time, Ownership Transfer, For Sale / Off Market.
- Priority: Transaction + Market Status = HIGH, Aircraft Information = MEDIUM, Financial Documents + Company/Contact = LOW.
- Events explain WHY snapshots and trends changed (ownership transfers, listings, accidents, lifecycle transitions).
- Use for: lifecycle timelines, market velocity, ownership churn, pre-listing detection, event-driven alerts, signal engines.

Analytics stack: EVENTS (raw) -> SNAPSHOTS (state) -> TRENDS (analytics).

## Flight Data Endpoints

Two endpoints for flight intelligence:

getFlightData (POST, paged) -- Granular per-flight records. Response key: flightdata.
  Required filters: startdate/enddate (MM/DD/YYYY), plus modlist or aclist.
  Fields: flightid, flightdate, origin, destination, flighttime, distance, estfuelburn, estCO2emissions, callsign.
  Ingestion strategy: batch by model + daily/weekly date windows.

getFlights (GET) -- GET /api/Aircraft/getFlights/{aircraftId}/{apiToken}
  Monthly utilization aggregates: flightyear, flightmonth, flights (count), flighthours.
  Response key: flights.
  Use for: utilization trends, CRM scoring, benchmarking.

Use getFlightData for route intelligence and emissions. Use getFlights for monthly trend analysis.

## File Manifest

| File | Purpose | Format |
|------|---------|--------|
| llms.txt | This file -- concise AI agent reference | Markdown |
| llms-full.txt | Complete reference (all docs concatenated) | Markdown |
| references/model-id-table.json | 872 model IDs with make/model/ICAO/fleet counts | JSON array |
| references/model-id-table.csv | Same data for spreadsheets | CSV |
| evals/evals.json | AI eval test cases | JSON |
| src/jetnet/session.py | Python session helper (drop into agent) | Python |
| src/jetnet/session.ts | TypeScript session helper | TypeScript |
| docs/response-shapes.md | Normalized response contracts with factories | Markdown |
| docs/common-mistakes.md | Every known gotcha | Markdown |
| docs/enum-reference.md | Valid enum values | Markdown |
| docs/authentication.md | Auth deep dive | Markdown |
| docs/bulk-export.md | Bulk export: snapshot/delta, graph change detection | Markdown |
| docs/history.md | Transaction history: ownership timeline, sales, leases | Markdown |
| docs/snapshots.md | Historical fleet state at a point in time | Markdown |
| docs/trends.md | Market trends & time-series analytics | Markdown |
| docs/events.md | Aircraft events: lifecycle changes, causal layer | Markdown |
| docs/flight-data.md | Flight endpoints: getFlightData + getFlights | Markdown |
| docs/pagination.md | Pagination patterns | Markdown |
| docs/response-handling.md | Schema differences by endpoint | Markdown |
| docs/id-system.md | ID types and usage | Markdown |
| references/endpoints.md | Full endpoint reference | Markdown |
| examples/responses/ | 16 known-good JSON response examples | JSON |
| prompts/ | 4 AI system prompts (Cursor/Copilot format) | Markdown |
